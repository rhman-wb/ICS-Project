{
  "id": "snapshot_1759118202807_i3uivaqed",
  "approvalId": "approval_1759117701455_ropidp9fm",
  "approvalTitle": "Product Template Enhancement Requirements Document",
  "version": 2,
  "timestamp": "2025-09-29T03:56:42.807Z",
  "trigger": "approved",
  "status": "pending",
  "content": "# 产品文档管理模板增强需求文档\r\n\r\n## Introduction\r\n\r\n本规格文档定义了对现有产品文档管理系统的模板增强功能，主要目标是替换现有的产品导入模板，支持两种新的官方模板：备案产品自主注册信息登记表和农险产品信息登记表。该增强功能将完善现有的导入、校验和数据存储功能，确保与新模板字段完全一致，并集成模板填写规则作为系统校验要求。\r\n\r\n此次增强是在现有product-document-management模块基础上的迭代改进，旨在提供更准确、更规范的产品导入体验，同时保持现有功能的稳定性和用户体验的一致性。\r\n\r\n## Alignment with Product Vision\r\n\r\n此功能增强直接支持产品概述中定义的核心目标：\r\n\r\n- **智能检核能力提升**：通过引入标准化的官方模板，提高产品信息的标准化程度，为后续智能检核提供更可靠的数据基础\r\n- **合规规则转化**：新模板集成了监管要求和填写规范，直接转化为可执行的校验规则，提升合规检查的准确性\r\n- **全要件管理优化**：完善产品要件导入的第一环节，确保从源头开始的数据质量和规范性\r\n- **用户体验优化**：为产品研发条线和合规团队提供更标准化、更便捷的产品导入工具\r\n\r\n该功能是实现\"保险产品智能检核系统\"整体愿景的重要基础组件，为后续的规则引擎、语义检索和LLM增强检核提供高质量的输入数据。\r\n\r\n## Requirements\r\n\r\n### Requirement 1: 双模板下载支持\r\n\r\n**User Story:** 作为业务用户，我希望在导入产品页面能够选择下载不同类型的官方模板，以便根据具体的产品类型选择合适的导入模板进行产品信息准备。\r\n\r\n#### Acceptance Criteria\r\n\r\n1. WHEN 用户进入\"导入产品\"页面 THEN 系统 SHALL 在页面顶部提供\"下载导入模板\"功能区域\r\n2. WHEN 显示模板下载区域 THEN 系统 SHALL 提供两个下载选项：\"备案产品自主注册信息登记表\"和\"农险产品信息登记表\"\r\n3. WHEN 用户点击\"备案产品自主注册信息登记表\"下载链接 THEN 系统 SHALL 下载\"附件3_备案产品自主注册信息登记表.xlsx\"文件\r\n4. WHEN 用户点击\"农险产品信息登记表\"下载链接 THEN 系统 SHALL 下载\"附件5_农险产品信息登记表.xls\"文件\r\n5. WHEN 下载过程中 THEN 系统 SHALL 显示下载进度提示并在完成后显示成功消息\r\n6. WHEN 模板文件无法下载 THEN 系统 SHALL 显示明确的错误信息并提供重试选项\r\n7. WHEN 用户首次访问页面 THEN 系统 SHALL 提供模板用途说明和选择指导\r\n\r\n### Requirement 2: 备案产品信息表单字段完整性\r\n\r\n**User Story:** 作为业务用户，我希望备案产品信息表单包含所有标准字段，确保与官方模板完全一致，避免数据缺失或不匹配问题。\r\n\r\n#### Acceptance Criteria\r\n\r\n1. WHEN 用户选择备案产品模板 THEN 系统 SHALL 显示包含30个标准字段的表单界面\r\n2. WHEN 显示必填字段 THEN 系统 SHALL 对以下字段使用红色星号标识：开发类型、产品名称、修订类型、示范条款名称（条件必填）\r\n3. WHEN 显示\"开发类型\"字段 THEN 系统 SHALL 提供下拉选择：自主开发、使用示范条款及参考纯风险损失率、仅使用示范条款、联合开发\r\n4. WHEN 显示\"示范条款名称\"字段 THEN 系统 SHALL 根据开发类型选择动态显示必填状态（使用示范条款时为必填）\r\n5. WHEN 显示\"报送类型\"字段 THEN 系统 SHALL 提供下拉选择：首次备案、产品修订\r\n6. WHEN 显示\"修订类型\"字段 THEN 系统 SHALL 根据报送类型动态显示（产品修订时可选）：扩展保险责任、缩减保险责任、调整费率、调整免赔额（率）、调整赔偿限额、其他\r\n7. WHEN 显示\"产品类别\"字段 THEN 系统 SHALL 提供下拉选择：财产损失保险、责任保险、信用保险和保证保险、农业保险、其他财产保险、短期健康保险、意外伤害保险\r\n8. WHEN 显示\"主附险类型\"字段 THEN 系统 SHALL 提供下拉选择：主险、附加险\r\n9. WHEN 显示\"经营范围\"字段 THEN 系统 SHALL 提供下拉选择：法人团体、机关团体、个人、个人/法人团体\r\n10. WHEN 显示\"经营区域1\"字段 THEN 系统 SHALL 提供下拉选择：全国（不含港澳台）、全国（含港澳台）、总公司、省级分公司\r\n11. WHEN 显示\"产品属性\"字段 THEN 系统 SHALL 提供下拉选择：中长期产品、一年期及一年期以下产品\r\n12. WHEN 显示\"是否有电子保单\"字段 THEN 系统 SHALL 提供下拉选择：是、否\r\n13. WHEN 显示\"是否是国产加密算法\"字段 THEN 系统 SHALL 提供下拉选择：是、否\r\n\r\n### Requirement 3: 农险产品信息表单字段完整性\r\n\r\n**User Story:** 作为业务用户，我希望农险产品信息表单包含所有农险特有字段，确保与农险产品信息登记表标准完全一致。\r\n\r\n#### Acceptance Criteria\r\n\r\n1. WHEN 用户选择农险产品模板 THEN 系统 SHALL 显示包含25个标准字段的表单界面\r\n2. WHEN 显示必填字段 THEN 系统 SHALL 对以下字段使用红色星号标识：产品名称、报送类型、修订类型\r\n3. WHEN 显示\"报送类型\"字段 THEN 系统 SHALL 提供下拉选择：新产品、修订产品\r\n4. WHEN 显示\"修订类型\"字段 THEN 系统 SHALL 根据报送类型动态显示（修订产品时为必填）：条款修订、费率修订、条款费率修订\r\n5. WHEN 显示\"开发方式\"字段 THEN 系统 SHALL 根据报送类型提供对应选项：新产品时选择\"自主开发/示范条款\"，修订产品时选择\"（农险适用）自主开发修订/（农险适用）示范条款修订\"\r\n6. WHEN 显示\"主附险\"字段 THEN 系统 SHALL 提供下拉选择：主险、附加险\r\n7. WHEN 显示\"产品类别\"字段 THEN 系统 SHALL 提供下拉选择：种植险、养殖险、不区分\r\n8. WHEN 显示\"产品性质\"字段 THEN 系统 SHALL 提供下拉选择：中央财政补贴型、地方财政补贴型、商业性\r\n9. WHEN 显示\"是否有电子保单\"字段 THEN 系统 SHALL 提供下拉选择：是、否\r\n10. WHEN 显示\"是否是国产密码算法\"字段 THEN 系统 SHALL 提供下拉选择：是、否\r\n11. WHEN 显示\"是否开办\"字段 THEN 系统 SHALL 提供下拉选择：是、否\r\n12. WHEN 显示\"经营区域\"字段 THEN 系统 SHALL 支持标准地区名称输入和验证\r\n\r\n### Requirement 4: 动态表单逻辑与字段联动\r\n\r\n**User Story:** 作为业务用户，我希望表单能够根据我的选择智能显示相关字段，避免填写不必要的信息，提高填写效率和准确性。\r\n\r\n#### Acceptance Criteria\r\n\r\n1. WHEN 备案产品中\"开发类型\"选择\"使用示范条款及参考纯风险损失率\"或\"仅使用示范条款\" THEN 系统 SHALL 将\"示范条款名称\"字段设为必填\r\n2. WHEN 备案产品中\"开发类型\"选择\"自主开发\"或\"联合开发\" THEN 系统 SHALL 隐藏或禁用\"示范条款名称\"字段\r\n3. WHEN 备案产品中\"报送类型\"选择\"产品修订\" THEN 系统 SHALL 显示并启用\"修订类型\"和\"原产品名称和备案编号\"字段\r\n4. WHEN 备案产品中\"报送类型\"选择\"首次备案\" THEN 系统 SHALL 隐藏\"修订类型\"和\"原产品名称和备案编号\"字段\r\n5. WHEN 备案产品中\"主附险类型\"选择\"附加险\" THEN 系统 SHALL 显示并要求填写\"主险情况\"字段\r\n6. WHEN 备案产品中\"经营区域1\"选择\"省级分公司\" THEN 系统 SHALL 显示并要求填写\"经营区域2\"字段\r\n7. WHEN 农险产品中\"报送类型\"选择\"修订产品\" THEN 系统 SHALL 显示\"修订类型\"、\"原产品名称和编号\"、\"修订次数\"字段\r\n8. WHEN 农险产品中\"主附险\"选择\"附加险\" THEN 系统 SHALL 显示并要求填写\"主险情况\"字段\r\n9. WHEN 字段状态发生变化 THEN 系统 SHALL 提供平滑的视觉过渡效果\r\n10. WHEN 用户输入无效选择组合 THEN 系统 SHALL 实时显示验证错误提示\r\n\r\n### Requirement 5: 模板文件解析与自动填充增强\r\n\r\n**User Story:** 作为业务用户，我希望系统能够准确解析新模板文件并自动填充对应字段，减少手动输入工作量，同时保持解析准确性。\r\n\r\n#### Acceptance Criteria\r\n\r\n1. WHEN 用户上传备案产品模板Excel文件 THEN 系统 SHALL 解析并识别30个标准字段的内容\r\n2. WHEN 用户上传农险产品模板Excel文件 THEN 系统 SHALL 解析并识别25个标准字段的内容\r\n3. WHEN 系统成功解析模板文件 THEN 系统 SHALL 自动填充对应的表单字段\r\n4. WHEN 模板文件包含下拉选项值 THEN 系统 SHALL 验证值是否在预定义选项列表中\r\n5. WHEN 解析到无效的下拉选项值 THEN 系统 SHALL 显示警告信息并保留原值供用户手动修正\r\n6. WHEN 模板文件格式不正确 THEN 系统 SHALL 显示具体的格式错误信息和修正建议\r\n7. WHEN 解析过程中发生错误 THEN 系统 SHALL 提供详细的错误日志和失败原因\r\n8. WHEN 部分字段解析失败 THEN 系统 SHALL 填充成功解析的字段并提示用户手动补充其余字段\r\n9. WHEN 自动填充完成 THEN 系统 SHALL 允许用户对所有字段进行手动修改\r\n10. WHEN 解析的数据与表单验证规则冲突 THEN 系统 SHALL 优先显示验证错误并指导用户修正\r\n\r\n### Requirement 6: 增强字段验证与规则集成\r\n\r\n**User Story:** 作为业务用户，我希望系统能够根据官方模板的填写规则对我的输入进行验证，确保数据的合规性和准确性。\r\n\r\n#### Acceptance Criteria\r\n\r\n1. WHEN 用户填写\"产品名称\"字段 THEN 系统 SHALL 验证名称以公司名称开头且以\"xxx保险\"格式结尾，不包含\"条款\"二字\r\n2. WHEN 用户填写备案产品\"产品名称\" THEN 系统 SHALL 限制字数不超过64个字符\r\n3. WHEN 用户填写\"基础费率（%）\"字段 THEN 系统 SHALL 验证输入为有效的数值且不包含百分号符号\r\n4. WHEN 用户填写\"年度\"字段 THEN 系统 SHALL 验证输入为有效的四位数年份格式\r\n5. WHEN 用户填写农险\"经营区域\" THEN 系统 SHALL 验证输入值是否在标准地区名称列表中\r\n6. WHEN 用户填写备案产品\"销售区域\" THEN 系统 SHALL 验证输入值符合标准地区名称且不能同时包含\"全国\"和具体省市\r\n7. WHEN 用户填写\"保险期间\"或\"保险责任\"字段 THEN 系统 SHALL 限制字数不超过2000个字符\r\n8. WHEN 字段验证失败 THEN 系统 SHALL 在对应字段下方显示红色错误提示信息\r\n9. WHEN 所有必填字段和验证规则通过 THEN 系统 SHALL 允许提交表单\r\n10. WHEN 提交前最终验证 THEN 系统 SHALL 执行完整的数据完整性和格式检查\r\n\r\n### Requirement 7: 数据存储模型优化\r\n\r\n**User Story:** 作为系统管理员，我希望系统能够正确存储新模板的所有字段数据，支持数据查询、统计和后续的智能检核功能。\r\n\r\n#### Acceptance Criteria\r\n\r\n1. WHEN 备案产品数据提交 THEN 系统 SHALL 将30个字段数据存储到对应的数据库表结构中\r\n2. WHEN 农险产品数据提交 THEN 系统 SHALL 将25个字段数据存储到对应的数据库表结构中\r\n3. WHEN 存储产品数据 THEN 系统 SHALL 保留模板类型标识以区分备案产品和农险产品\r\n4. WHEN 存储下拉选项数据 THEN 系统 SHALL 保存选项的代码值和显示名称\r\n5. WHEN 数据存储失败 THEN 系统 SHALL 回滚事务并向用户显示明确的错误信息\r\n6. WHEN 存储成功 THEN 系统 SHALL 生成唯一的产品标识符并返回给前端\r\n7. WHEN 查询产品列表 THEN 系统 SHALL 根据模板类型正确显示对应的字段值\r\n8. WHEN 产品数据用于后续检核 THEN 系统 SHALL 确保字段映射的正确性和完整性\r\n9. WHEN 进行数据统计 THEN 系统 SHALL 支持按新增字段进行分组和汇总查询\r\n10. WHEN 数据备份恢复 THEN 系统 SHALL 保持新字段数据的完整性\r\n\r\n### Requirement 8: 向后兼容性保障\r\n\r\n**User Story:** 作为现有系统用户，我希望新功能的引入不会影响现有数据的访问和已有功能的正常使用。\r\n\r\n#### Acceptance Criteria\r\n\r\n1. WHEN 访问历史产品数据 THEN 系统 SHALL 正常显示现有字段信息，新增字段显示为空值或默认值\r\n2. WHEN 使用现有的产品查询功能 THEN 系统 SHALL 继续正常工作，新增字段作为可选查询条件\r\n3. WHEN 导出产品数据 THEN 系统 SHALL 包含所有字段，历史数据的新字段显示为空\r\n4. WHEN 现有API接口调用 THEN 系统 SHALL 保持向后兼容，新增字段作为可选参数\r\n5. WHEN 系统升级部署 THEN 系统 SHALL 自动执行数据库迁移脚本添加新字段\r\n6. WHEN 数据迁移过程中 THEN 系统 SHALL 保持现有数据的完整性不受影响\r\n7. WHEN 旧版本客户端访问 THEN 系统 SHALL 优雅处理未知字段并返回兼容的数据格式\r\n8. WHEN 配置管理 THEN 系统 SHALL 支持新旧模板配置的平滑切换\r\n9. WHEN 错误处理 THEN 系统 SHALL 为新功能提供独立的错误处理逻辑，不影响现有功能\r\n10. WHEN 性能测试 THEN 系统 SHALL 确保新增字段不会显著影响现有功能的响应时间\r\n\r\n## Non-Functional Requirements\r\n\r\n### Code Architecture and Modularity\r\n- **Single Responsibility Principle**: 模板解析、字段验证、数据存储功能应分别独立实现\r\n- **Modular Design**: 新增功能应通过可配置的模块化组件实现，便于维护和扩展\r\n- **Dependency Management**: 模板处理逻辑应与现有业务逻辑解耦，通过清晰的接口交互\r\n- **Clear Interfaces**: 定义标准的模板配置接口，支持未来添加更多模板类型\r\n\r\n### Performance\r\n- 模板文件解析时间不超过3秒（文件大小≤5MB）\r\n- 表单字段验证响应时间不超过500毫秒\r\n- 数据存储操作完成时间不超过2秒\r\n- 产品列表查询支持分页，单页响应时间不超过1秒\r\n- 支持并发用户数≥100，系统响应时间不超过5秒\r\n\r\n### Security\r\n- 上传文件类型严格限制为.xlsx和.xls格式\r\n- 文件大小限制为5MB，防止恶意大文件攻击\r\n- 输入数据进行SQL注入和XSS攻击防护\r\n- 敏感字段（如费率信息）进行访问权限控制\r\n- 所有用户操作记录审计日志\r\n- 数据传输使用HTTPS加密\r\n\r\n### Reliability\r\n- 系统可用性≥99.5%\r\n- 数据库事务支持，确保数据一致性\r\n- 文件上传失败时提供重试机制\r\n- 系统异常时能够优雅降级，保证核心功能可用\r\n- 定期数据备份，RTO≤4小时，RPO≤1小时\r\n\r\n### Usability\r\n- 表单填写向导模式，分步骤引导用户完成\r\n- 实时字段验证，即时反馈错误信息\r\n- 智能字段联动，根据选择自动显示相关字段\r\n- 支持表单数据暂存，避免意外丢失\r\n- 提供详细的帮助文档和字段说明\r\n- 响应式设计，支持桌面和平板设备\r\n- 支持键盘快捷键操作，提高操作效率",
  "fileStats": {
    "size": 14994,
    "lines": 197,
    "lastModified": "2025-09-29T03:48:03.474Z"
  },
  "comments": []
}